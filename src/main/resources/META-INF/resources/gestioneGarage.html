<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Gestione Garage</title>
<link rel="stylesheet" href="CSS/style.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript">
	
	function add() {
		var marca = document.getElementById("aggiungi").elements[0].value;
		var modello = document.getElementById("aggiungi").elements[1].value;
		var colore = document.getElementById("aggiungi").elements[2].value;

		const data = {
			"colore" : colore,
			"modello" : modello,
			"marca" : marca
		};
		if(colore==""||modello===""||marca===""){
			$('#aggiunta').css('color', 'red');
			$('#aggiunta').text("inserire tutti i campi")
		}
		else{
			$(document).ready(function(){
			$.ajax({ 
					url: 'garage',
					type: 'POST',
					data: JSON.stringify(data),
					contentType: 'application/json',
					success: function(result){
						$('#aggiunta').css('color', 'green');
						$('#aggiunta').text(JSON.stringify(data) + " AGGIUNTA CON SUCCESSO!");
						console.log(data);
					},
				    error: function(result){
						console.log(result);
					}
			});
		});
		}


	}

	function del() {
		var id = document.getElementById("elimina").elements[0].value;

		$(document).ready(function(){
			$.ajax({ 
					url: 'garage/auto/' + id,
					type: 'DELETE',
					contentType: 'application/json',
					success: function(result){
						$('#eliminata').css('color', 'green');
						$('#eliminata').text(" ELIMINATA CON SUCCESSO!");
						
						
					},
				    error: function(result){
				    	$('#eliminata').css('color', 'red');
				    	$('#eliminata').text("NON E' PRESENTE NESSUNA AUTO CON ID " + id);
				    	
					}
			});
		});

	}

	function get() {
		var id = document.getElementById("recupera").elements[0].value;

		$(document).ready(function(){
			$.ajax({ 
					url: 'garage/auto/'+id,
					type: 'GET',
					contentType: 'application/json',
					success: function(result, textStatus, jqXHR){
						  console.log(jqXHR.statusText);
						  if(jqXHR.statusText === "OK"){
							  $('#auto').css('color', 'green');
							  $("#auto").html("Automobile con id (" + result.id + ") : " + result.marca + " " + result.modello + " " + result.colore); 
						  }
						  else{
							  $('#auto').css('color', 'red');
						      $('#auto').text("NON E' PRESENTE NESSUNA AUTO CON ID " + id);	
						  }  
					},
				    error: function(result, textStatus, jqXHR){
				    	 console.log(textStatus);
					}
			});
		});
}
	
	function menu() {
		  var x = document.getElementById("myTopnav");
		  if (x.className === "topnav") {
		    x.className += " responsive";
		  } else {
		    x.className = "topnav";
		  }
		}
	
</script>
</head>
<body>
	<div class="topnav" id="myTopnav">
		  <a href="home.html">HOME</a>
		  <a href="gestioneGarage.html" class="active">GESTISCI GARAGE</a>
		  <a href="ricerca.html">RICERCA AUTO</a>
		  <a href="modificaGarage.html">MODIFICA AUTO</a>
		  <a href="javascript:void(0);" class="icon" onclick="menu()">
		    <i class="fa fa-bars"></i>
		  </a>
		</div>

	<div>
		<h1 align="center">GESTIONE GARAGE</h1>

		<div class = "container">
			<div class= "item">


				<h3>Aggiungi un'automobile</h3>
				<form id='aggiungi' onSubmit="return false;">
					<div class="row">
						<div>
							<input type="text" placeholder="Marca" size="60"
								required="required" />
						</div>
					</div>
					<div class="row">
						<div>
							<input type="text" placeholder="Modello" size="60"
								required="required" />
						</div>
					</div>
					<div class="row">
						<div>
							<input type="text" placeholder="Colore" size="60"
								required="required" />
						</div>
					</div>
					<br>
					<input class="bottone" type="reset" value="Reset" /> <input class="bottone" type="submit"
						value="Aggiungi" onclick='add()' />
				</form>
				<div id="aggiunta"></div>
			</div>

			<div class="item">


				<h3>Elimina un'automobile</h3>
				<form id='elimina' onSubmit="return false;">
					<div class="row">
						<div>
							<input type="text" placeholder="Id" size="60" />
						</div>
					</div>
					<input class="bottone" type="reset" value="Reset" /> <input class="bottone" type="submit"
						value="Elimina" onclick='del()' />

				</form>
				<div id="eliminata"></div>
			</div>
		

		
			<div class="item">


				<h3>Recupera un'automobile tramite il suo id</h3>
				<form id='recupera' onSubmit="return false;">
					<div class="row">
						<div>
							<input type="text" placeholder="Id" size="60" />
						</div>
					</div>
					<input class="bottone" type="reset" value="Reset" /> <input class="bottone" type="submit"
						value="Recupera" onclick='get()' /> <br>
					<div id="auto"></div>
					<br>
			</form>
			</div>
		</div>
	
</body>
</html>