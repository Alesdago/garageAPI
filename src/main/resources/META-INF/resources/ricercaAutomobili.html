<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Ricerca Automobili</title>
<link rel="stylesheet" href="stile.css" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript">


function apri() {

	  var marca = document.getElementById("marca");
	  var modello = document.getElementById("modello");
	  var colore = document.getElementById("colore");

	  var ma = document.getElementById("ma");
	  var mo = document.getElementById("mo");
	  var co = document.getElementById("co");

	  
	  if (marca.checked == true){
	    ma.style.display = "block";
	  }
	  else {
	    ma.style.display = "none"; 
	  }
	  
	  if(modello.checked == true){
		  mo.style.display = "block";
	  }
	  else{
		  mo.style.display = "none"
	  }
	  
	  if(colore.checked == true){
		  co.style.display = "block";
	  }
	  else{
		  co.style.display = "none"
	  }
	}
	
	var marche=[];
	
	var colori=[];
	
	var modelli=[];
	
	function aggiungi(){
		
		marche.push(document.getElementById("inMarca").value);
		modelli.push(document.getElementById("inModello").value);
		colori.push(document.getElementById("inColore").value);
		
		document.getElementById('inMarca').value = "";
		document.getElementById('inModello').value = "";
		document.getElementById('inColore').value = "";
		
		
		var marca = document.getElementById("marca");
		var modello = document.getElementById("modello");
		var colore = document.getElementById("colore");
		
		  if (marca.checked == true){
			var stringaMarche = "";
			for(var i=0; i<marche.length; i++){
				stringaMarche = stringaMarche.concat(marche[i] + " ");
			}
			$("#listaMarche").html(stringaMarche);
		    
		  }
		  else {
		    ma.style.display = "none"; 
		  }
		  
		  if(modello.checked == true){
			  var stringaModelli = "";
				for(var i=0; i<modelli.length; i++){
					stringaModelli =  stringaModelli.concat(modelli[i] + " ");
				}
				$("#listaModelli").html(stringaModelli);
		  }
		  else{
			  mo.style.display = "none"
		  }
		  
		  if(colore.checked == true){
			  var stringaColori = "";
				for(var i=0; i<colori.length; i++){
					stringaColori = stringaColori.concat(colori[i] + " ");
				}
				$("#listaColori").html(stringaColori);
		  }
		  else{
			  co.style.display = "none"
			  }
	}
	
	function ricerca(){
		 /*[
			  {
			    "campo": "marca",
			    "parametri": [
			      "fiat", "citroen"
			    ]
			  },
			  {
			    "campo": "colore",
			    "parametri": [
			      "verde"
			    ]
			  }
		  ]
		 
		 
		 PROBLEMI:
		
			 2 I NOSTRI PARAMETRI NON HANNO LE VIRGOLETTE
		*/
		
		var marca = document.getElementById("marca");
		var modello = document.getElementById("modello");
		var colore = document.getElementById("colore");
		var parametroMarca = "";
		
		for (var i=0; i<marche.length; i++) {
			if(i == marche.length){
				parametroMarca.concat("\"" + marche[i] + "\"");
			}
			else {
			parametroMarca.concat("\"" + marche[i] + "\",");
			}
		}
		alert(parametroMarca);
		var ricercami;
		if(marca.checked == true && modello.checked == true && colore.checked == true){
			ricercami = [
				  {
				    "campo": "marca",
				    "parametri": [ marche ]
				  },
				  {
				    "campo": "modello",
				    "parametri": [ modelli ]
				  },
				  {
				    "campo": "colore",
				    "parametri": [ colori ]
				  }
			 ];
		}
		else if(marca.checked == true && modello.checked == true && colore.checked == false){
			ricercami = [
				  {
				    "campo": "marca",
				    "parametri": [ marche ]
				  },
				  {
				    "campo": "modello",
				    "parametri": [ modelli ]
				  }
			 ];
		}
		else if(marca.checked == true && modello.checked == false && colore.checked == true){
			ricercami = [
				  {
				    "campo": "marca",
				    "parametri": [ marche ]
				  },
				  {
				    "campo": "colore",
				    "parametri": [ colori ]
				  }
			 ];
		}
		else if(marca.checked == false && modello.checked == true && colore.checked == true){
			ricercami = [
				  {
				    "campo": "modello",
				    "parametri": [ modelli ]
				  },
				  {
				    "campo": "colore",
				    "parametri": [ colori ]
				  }
			 ];
		}
		else if(marca.checked == true && modello.checked == false && colore.checked == false){
			ricercami = [
				  {
				    "campo": "marca",
				    "parametri": [ parametroMarca ]
				  }
			 ];
		}
		else if(marca.checked == false && modello.checked == true && colore.checked == false){
			ricercami = [
				  {
				    "campo": "modello",
				    "parametri": [ modelli ]
				  }
			 ];
		}
		else if(marca.checked == false && modello.checked == false && colore.checked == true){
			ricercami = [
				  {
				    "campo": "colore",
				    "parametri": [ colori ]
				  }
			 ];
		}
		
		alert(ricercami);
		$(document).ready(function(){
			$.ajax({ 
					url: 'http://localhost:8080/garage/ricerca',
					type: 'POST',
					data: $.parseJSON(ricercami),
					contentType: 'application/json',
					success: function(result){
						$("#divId").html(result.id);
						$("#divColore").html(result.colore);
						$("#divModello").html(result.modello);
						$("#divMarca").html(result.marca);
						console.log(result);
					},
				    error: function(result){
						console.log(result);
					}
			});
		});
	}
	

	  
	  

     
    </script>
</head>
<body class="sfondo">
	<div class="container">
		<h1 align="center">Ricerca automobili nel garage</h1>

		<div style="width: 100%; float: left;">
			<div style="width: 50%; float: left;">


				<h3>Ricerca automobili</h3>
				<form onSubmit="return false;">
					<div class="row">
						<div class="col-6">

							<label style="color: white"> Cerca per marca: </label> <input
								type="checkbox" id="marca" onclick="apri()">


							<p id='ma' style="display: none">
								<input type="text" placeholder="Marca" id="inMarca" size="60">
								<a href=# onclick="aggiungi()"> Aggiungi</a>
							</p>
							<p id="listaMarche"></p>

						</div>
					</div>
					<div class="row">
						<div class="col-6">
							<label style="color: white"> Cerca per modello: </label> <input
								type="checkbox" id="modello" onclick="apri()">


							<p id="mo" style="display: none">
								<input type="text" placeholder="Modello" id="inModello"
									size="60"> <a href=# onclick="aggiungi()"> Aggiungi</a>
							</p>
							<p id="listaModelli"></p>

						</div>
					</div>
					<div class="row">
						<div class="col-6">
							<label style="color: white"> Cerca per colore: </label> 
							<input type="checkbox" id="colore" onclick="apri()">


							<p id="co" style="display: none">
								<input type="text" placeholder="Colore" id="inColore" size="60"> 
								<a href=# onclick="aggiungi()"> Aggiungi</a>
							</p>
							<p id="listaColori"></p>
							
							
						</div>
					</div> 
					<input type="submit" value="Ricerca" onclick="ricerca()" />
				</form>
			</div>


			<div style="width: 50%; float: left;">
				<h3>Garage</h3>
				<div class="row">
					<div class="col-3">ID</div>
					<div class="col-3">COLORE</div>
					<div class="col-3">MODELLO</div>
					<div class="col-3">MARCA</div>
				</div>
				<div class="row">
					<div class="col-3" id="divId"></div>
					<div class="col-3" id="divColore"></div>
					<div class="col-3" id="divModello"></div>
					<div class="col-3" id="divMarca"></div>
				</div>
			</div>
		</div>

		<div align="center">
			<a href="home.html"><button>Torna alla home</button></a>
		</div>
	</div>
</body>
</html>
